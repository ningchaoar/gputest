# docker run --name chaon_tgi --gpus all --shm-size 8g -p 8080:80 -v ${PWD}:/work ghcr.io/huggingface/text-generation-inference:1.0.3 --model-id /work/ckpts/Llama-2-70B-fp16 --max-input-length 4096 --max-total-tokens 8192 --num-shard 8
# docker run --name chaon_tgi --gpus all --shm-size 8g -p 8080:80 -v ${PWD}:/work ghcr.io/huggingface/text-generation-inference:1.0.3 --model-id /work/moe/facebook_nllb-moe-54b --max-input-length 4096 --max-total-tokens 8192 --num-shard 4

# prompt="Hello, my llama is cute, but don't be fooled by its innocent appearance.This fluffy bundle of fur is full of surprises.Its name is Larry, and Larry is not your average llama.Larry has a mischievous twinkle in his eye that hints at the adventures we've had together.One sunny morning, Larry and I decided to go on an exciting journey through the rolling hills of our hometown.As we strolled along, Larry's curiosity got the best of him.He suddenly darted off the path and into a dense thicket of bushes.I followed, my heart racing, wondering what had caught his attention.To my amazement, I found Larry standing in front of a hidden treasure chest buried in the underbrush.With his hoof, he started digging it out, and to our astonishment,we discovered a trove of ancient maps and mysterious artifacts.It seemed as though Larry had a sixth sense for adventure, and he had led us to this incredible discovery.Over the following weeks, Larry and I became the town's talk,and we began our journey to uncover the secrets of the maps.We embarked on a series of daring expeditions, solving riddles,decoding ancient scripts, and traversing treacherous terrain.Larry's clever instincts and my determination made us an unstoppable team.As we continued our adventures, Larry's cuteness proved to be a valuable asset.People couldn't resist his adorable face, which often helped us win the trustand assistance of locals in our quest. Larry's charm was our secret weapon,and together we forged lasting friendships with the communities we encountered along the way.Our adventures with Larry the cute llama took us to the farthest corners of the earth,unlocking ancient mysteries and uncovering hidden treasures.But no matter where our journey led, one thing was for certain:Larry's cuteness was matched only by his sense of adventure,making him the perfect companion for a life filled with excitement and discovery.One day, while on an expedition deep in the heart of the Amazon rain, Hello, my llama is cute, but don't be fooled by its innocent appearance.This fluffy bundle of fur is full of surprises.Its name is Larry, and Larry is not your average llama.Larry has a mischievous twinkle in his eye that hints at the adventures we've had together.One sunny morning, Larry and I decided to go on an exciting journey through the rolling hills of our hometown.As we strolled along, Larry's curiosity got the best of him.He suddenly darted off the path and into a dense thicket of bushes.I followed, my heart racing, wondering what had caught his attention.To my amazement, I found Larry standing in front of a hidden treasure chest buried in the underbrush.With his hoof, he started digging it out, and to our astonishment,we discovered a trove of ancient maps and mysterious artifacts.It seemed as though Larry had a sixth sense for adventure, and he had led us to this incredible discovery.Over the following weeks, Larry and I became the town's talk,and we began our journey to uncover the secrets of the maps.We embarked on a series of daring expeditions, solving riddles,decoding ancient scripts, and traversing treacherous terrain.Larry's clever instincts and my determination made us an unstoppable team.As we continued our adventures, Larry's cuteness proved to be a valuable asset.People couldn't resist his adorable face, which often helped us win the trustand assistance of locals in our quest. Larry's charm was our secret weapon,and together we forged lasting friendships with the communities we encountered along the way.Our adventures with Larry the cute llama took us to the farthest corners of the earth,unlocking ancient mysteries and uncovering hidden treasures.But no matter where our journey led, one thing was for certain:Larry's cuteness was matched only by his sense of adventure,making him the perfect companion for a life filled with excitement and discovery.One day, while on an expedition deep in the heart of the Amazon rain, Hello, my llama is cute, but don't be fooled by its innocent appearance.This fluffy bundle of fur is full of surprises.Its name is Larry, and Larry is not your average llama.Larry has a mischievous twinkle in his eye that hints at the adventures we've had together.One sunny morning, Larry and I decided to go on an exciting journey through the rolling hills of our hometown.As we strolled along, Larry's curiosity got the best of him.He suddenly darted off the path and into a dense thicket of bushes.I followed, my heart racing, wondering what had caught his attention.To my amazement, I found Larry standing in front of a hidden treasure chest buried in the underbrush.With his hoof, he started digging it out, and to our astonishment,we discovered a trove of ancient maps and mysterious artifacts.It seemed as though Larry had a sixth sense for adventure, and he had led us to this incredible discovery.Over the following weeks, Larry and I became the town's talk,and we began our journey to uncover the secrets of the maps.We embarked on a series of daring expeditions, solving riddles,decoding ancient scripts, and traversing treacherous terrain.Larry's clever instincts and my determination made us an unstoppable team.As we continued our adventures, Larry's cuteness proved to be a valuable asset.People couldn't resist his adorable face, which often helped us win the trustand assistance of locals in our quest. Larry's charm was our secret weapon,and together we forged lasting friendships with the communities we encountered along the way.Our adventures with Larry the cute llama took us to the farthest corners of the earth,unlocking ancient mysteries and uncovering hidden treasures.But no matter where our journey led, one thing was for certain:Larry's cuteness was matched only by his sense of adventure,making him the perfect companion for a life filled with excitement and discovery.One day, while on an expedition deep in the heart of the Amazon rain, Hello, my llama is cute, but don't be fooled by its innocent appearance.This fluffy bundle of fur is full of surprises.Its name is Larry, and Larry is not your average llama.Larry has a mischievous twinkle in his eye that hints at the adventures we've had together.One sunny morning, Larry and I decided to go on an exciting journey through the rolling hills of our hometown.As we strolled along, Larry's curiosity got the best of him.He suddenly darted off the path and into a dense thicket of bushes.I followed, my heart racing, wondering what had caught his attention.To my amazement, I found Larry standing in front of a hidden treasure chest buried in the underbrush.With his hoof, he started digging it out, and to our astonishment,we discovered a trove of ancient maps and mysterious artifacts.It seemed as though Larry had a sixth sense for adventure, and he had led us to this incredible discovery.Over the following weeks, Larry and I became the town's talk,and we began our journey to uncover the secrets of the maps.We embarked on a series of daring expeditions, solving riddles,decoding ancient scripts, and traversing treacherous terrain.Larry's clever instincts and my determination made us an unstoppable team.As we continued our adventures, Larry's cuteness proved to be a valuable asset.People couldn't resist his adorable face, which often helped us win the trustand assistance of locals in our quest. Larry's charm was our secret weapon,and together we forged lasting friendships with the communities we encountered along the way.Our adventures with Larry the cute llama took us to the farthest corners of the earth,unlocking ancient mysteries and uncovering hidden treasures.But no matter where our journey led, one thing was for certain:Larry's cuteness was matched only by his sense of adventure,making him the perfect companion for a life filled with excitement and discovery.One day, while on an expedition deep in the heart of the Amazon rain,"

# curl 127.0.0.1:8080/generate \
#     -X POST \
#     -d "{\"inputs\":[\"$prompt\", "Hello"],\"parameters\":{\"max_new_tokens\":64}}" \
#     -H 'Content-Type: application/json'

# curl 127.0.0.1:8080/generate \
#     -X POST \
#     -d '{"inputs":{"How are you", "Hello"},"parameters":{"max_new_tokens":20}}' \
#     -H 'Content-Type: application/json'

# python run.py -b 8 --output-length 64
# python run.py -b 8 --output-length 256
# python run.py -b 16 --output-length 64
# python run.py -b 32 --output-length 64
# python run.py -b 16 --output-length 256
# python run.py -b 64 --output-length 64
# python run.py -b 64 --output-length 256
python run.py -b 8 --output-length 64 --long
python run.py -b 8 --output-length 256 --long
python run.py -b 16 --output-length 64 --long
python run.py -b 32 --output-length 64 --long
python run.py -b 16 --output-length 256 --long
python run.py -b 64 --output-length 64 --long
python run.py -b 64 --output-length 256 --long